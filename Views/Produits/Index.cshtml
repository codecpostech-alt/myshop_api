@model IEnumerable<MyShop.Models.Produit>

@{
    ViewBag.Title = "Liste des Produits";
    Layout = "_Layout";
}

<div class="page-container rtl">
    <!-- 🔷 رأس الصفحة -->
    <div class="header-bar shadow-sm d-flex flex-column align-items-center">
        <h2 class="page-title text-center mb-2"><i class="bi bi-box-seam me-2"></i> LISTE DES PRODUITS</h2>
        <p class="text-light m-0 text-center">Gérez vos stock facilement depuis ce tableau</p>
        <!-- زر Ajouter على اليمين -->
        <a href="@Url.Action("Save", "Produits")" class="btn btn-gradient mt-3 align-self-end">
            <i class="bi bi-plus-circle me-2"></i> Ajouter un produit
        </a>
    </div>

    <!-- 🔍 شريط البحث -->
    <div class="search-bar mt-4 d-flex justify-content-start">
        <input type="text" id="searchInput" class="form-control form-control-lg w-50" placeholder="🔍 Rechercher par nom du produit..." />
    </div>

    <!-- 🧾 جدول عرض المنتجات (LTR داخل الصفحة RTL) -->
    <div class="table-responsive mt-4 shadow-sm ltr">
        <table class="table table-hover align-middle" id="produitsTable">
            <thead>
                <tr>
                    <th class="text-start">Nom du produit</th>
                    <th class="text-start">Catégorie</th>
                    <th class="text-start">Quantité</th>
                    <th class="text-start">Prix d'achat (DA)</th>
                    <th class="text-start">Prix de vente (DA)</th>
                    <th class="text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var item in Model)
                    {
                        <tr class="table-row">
                            <td class="fw-semibold text-dark text-start">@item.Nom</td>
                            <td class="text-start">@item.Categorie</td>
                            <td class="text-start">@item.Quantite</td>
                            <td class="text-primary fw-bold text-start">@item.PrixAchat.ToString("N2")</td>
                            <td class="text-success fw-bold text-start">@item.PrixVente.ToString("N2")</td>
                            <td class="text-end">
                                <a href="@Url.Action("Save", "Produits", new { id = item.Id })" class="btn-action edit" title="Modifier">
                                    <i class="bi bi-pencil-square"></i>
                                </a>
                                <a href="@Url.Action("Delete", "Produits", new { id = item.Id })" class="btn-action delete" title="Supprimer" onclick="return confirm('Voulez-vous vraiment supprimer ce produit ?');">
                                    <i class="bi bi-trash"></i>
                                </a>
                                <a href="@Url.Action("Print", "Produits", new { id = item.Id })" class="btn-action print" title="Imprimer">
                                    <i class="bi bi-printer"></i>
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="6" class="text-muted py-4 text-center">Aucun produit trouvé.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <footer class="footer-note mt-5">
        <small>© @DateTime.Now.Year - <strong>CODEC SHOP</strong> | Gestion des produits</small>
    </footer>
</div>

@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap" rel="stylesheet" />

    <style>
        body {
            background: linear-gradient(135deg, #f0f4f8, #d9e8fb);
            font-family: 'Cairo', sans-serif;
            direction: rtl;
        }

        .rtl {
            direction: rtl;
        }

        .ltr {
            direction: ltr;
        }

        .page-container {
            max-width: 1150px;
            margin: 50px auto;
            background: #fff;
            border-radius: 20px;
            padding: 40px 50px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .header-bar {
            background: linear-gradient(90deg, #007bff, #00b4d8);
            padding: 20px 25px;
            border-radius: 16px;
            color: white;
        }

        .page-title {
            font-weight: 700;
            font-size: 1.8rem;
        }

        .btn-gradient {
            background: linear-gradient(90deg, #00b4d8, #007bff);
            border: none;
            color: #fff;
            font-weight: 700;
            padding: 10px 20px;
            border-radius: 12px;
            transition: 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }

            .btn-gradient:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(0,123,255,0.5);
            }

        .search-bar input {
            border-radius: 12px;
            padding: 14px 20px;
            font-size: 1.1rem;
            border: 1px solid #d0d7de;
            text-align: left;
            transition: 0.3s;
        }

            .search-bar input:focus {
                box-shadow: 0 0 10px rgba(0,123,255,0.3);
                border-color: #007bff;
            }

        table {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }

        thead tr {
            background: #f1f5f9;
            font-weight: 700;
            color: #333;
            text-align: left;
        }

        tbody tr {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }

            tbody tr:hover {
                background: #e8f0fe;
                transform: scale(1.01);
            }

        .btn-action {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            margin: 0 3px;
            color: white;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

            .btn-action.edit {
                background-color: #ffc107;
            }

            .btn-action.delete {
                background-color: #dc3545;
            }

            .btn-action.print {
                background-color: #0dcaf0;
            }

            .btn-action:hover {
                opacity: 0.9;
                transform: scale(1.15);
            }

        .footer-note {
            text-align: center;
            margin-top: 50px;
            color: #555;
            font-weight: 500;
        }
    </style>
}

@section Scripts {
    <script>
        document.getElementById("searchInput").addEventListener("keyup", function () {
            let filter = this.value.toLowerCase();
            let rows = document.querySelectorAll("#produitsTable tbody tr");

            rows.forEach(row => {
                let nomProduit = row.querySelector("td:first-child").textContent.toLowerCase();
                row.style.display = nomProduit.includes(filter) ? "" : "none";
            });
        });
    </script>
}