@model MyShop.Models.Frais
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Ajouter un Frais";
}

<!-- استدعاء Bootstrap و SweetAlert2 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
    body {
        background: linear-gradient(135deg, #f6f9ff, #eef3fb);
        font-family: 'Segoe UI', sans-serif;
    }

    .card {
        border-radius: 18px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

    .form-label {
        color: #003366;
        font-weight: 600;
    }

    .btn-success {
        background: #009879;
        border: none;
        transition: 0.3s;
    }

        .btn-success:hover {
            background: #007f67;
        }

    .btn-secondary {
        background: #6c757d;
        border: none;
    }

    /* ✅ اجعل كل الحقول والـ labels منسقة من اليسار */
    form#fraisForm {
        direction: ltr; /* اتجاه الكتابة من اليسار لليمين */
        text-align: left; /* محاذاة النص لليسار */
    }

        form#fraisForm input,
        form#fraisForm textarea,
        form#fraisForm select {
            direction: ltr;
            text-align: left;
        }

            form#fraisForm input::placeholder,
            form#fraisForm textarea::placeholder {
                text-align: left;
            }
</style>

<div class="container mt-5">
    <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white text-start py-3">
            <h4 class="mb-0"><i class="bi bi-wallet2"></i> Ajouter un Frais</h4>
        </div>

        <div class="card-body px-5 py-4">
            <form asp-action="Create" method="post" id="fraisForm">
                @Html.AntiForgeryToken()

                <!-- نوع المصروف -->
                <div class="mb-4">
                    <label asp-for="Type" class="form-label"><i class="bi bi-tag"></i> Type de frais</label>
                    <select asp-for="Type" class="form-select shadow-sm" required>
                        <option value="">-- Sélectionner un type --</option>
                        <option value="Loyer">🏠 Loyer (إيجار)</option>
                        <option value="Électricité">💡 Électricité (كهرباء)</option>
                        <option value="Internet">🌐 Internet</option>
                        <option value="Fournitures">📦 Fournitures (مستلزمات)</option>
                        <option value="Transport">🚗 Transport (نقل)</option>
                        <option value="Autre">🧾 Autre (أخرى)</option>
                    </select>
                    <span asp-validation-for="Type" class="text-danger"></span>
                </div>

                <!-- المبلغ -->
                <div class="mb-4">
                    <label asp-for="Montant" class="form-label"><i class="bi bi-cash-coin"></i> Montant (DA)</label>
                    <input asp-for="Montant" class="form-control shadow-sm" type="number" step="0.01" placeholder="Entrez le montant" required />
                    <span asp-validation-for="Montant" class="text-danger"></span>
                </div>

                <!-- الوصف -->
                <div class="mb-4">
                    <label asp-for="Description" class="form-label"><i class="bi bi-text-left"></i> Description</label>
                    <textarea asp-for="Description" class="form-control shadow-sm" rows="3" placeholder="Ajoutez une description (facultatif)"></textarea>
                    <span asp-validation-for="Description" class="text-danger"></span>
                </div>

                <!-- المستخدم -->
                <div class="mb-4">
                    <label class="form-label"><i class="bi bi-person-badge"></i> Utilisateur</label>
                    <input type="text" class="form-control shadow-sm bg-light"
                           value="@HttpContextAccessor.HttpContext.Session.GetString("UserName")" readonly />
                </div>

                <!-- أزرار -->
                <div class="text-start">
                    <button type="submit" class="btn btn-success px-4 py-2 me-2">
                        <i class="bi bi-check-circle"></i> Enregistrer
                    </button>
                    <a asp-action="Index" class="btn btn-secondary px-4 py-2">
                        <i class="bi bi-arrow-left"></i> Retour
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- إشعار نجاح -->
<script>
    document.getElementById("fraisForm").addEventListener("submit", function (e) {
        e.preventDefault();

        Swal.fire({
            title: 'Enregistrement...',
            text: 'Veuillez patienter',
            icon: 'info',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });

        this.submit();

        setTimeout(() => {
            Swal.fire({
                icon: 'success',
                title: 'Frais ajouté avec succès 🎉',
                showConfirmButton: false,
                timer: 2000
            });
        }, 500);
    });
</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}